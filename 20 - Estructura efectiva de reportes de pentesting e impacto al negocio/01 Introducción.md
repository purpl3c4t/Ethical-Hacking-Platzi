# Estructura Efectiva de Reportes de Pentesting e Impacto al Negocio

El entregable final de una prueba de penetración no es el acceso conseguido a un servidor ni la contraseña obtenida, sino el **informe**. Un pentest exitoso con un reporte deficiente es un fracaso profesional, ya que no comunica el valor del hallazgo ni guía a la organización hacia la remediación.

El informe debe servir como un puente de traducción entre los hallazgos técnicos complejos y las decisiones de negocio estratégicas. Para lograr esto, el documento se divide en dos secciones principales dirigidas a audiencias distintas: el Resumen Ejecutivo y el Informe Técnico.

---

## Evaluación de Riesgo e Impacto al Negocio

No todas las vulnerabilidades tienen el mismo impacto.Para poder dirigit adecuadamente los esfuerzos a las vulnerabilidades en el orden correcto, debemos saber priorizarlas. 
Para priorizar, utilizamos la ecuación fundamental del riesgo:

$$Riesgo = Impacto \times Probabilidad$$

### A. Impacto (La Consecuencia)
Mide el daño que sufriría la organización si la vulnerabilidad fuera explotada exitosamente. Se evalúa bajo dos lentes:

**1. Impacto Técnico (Tríada CIA):**
* **Confidencialidad:** ¿Se divulgan datos sensibles?
* **Integridad:** ¿Pueden modificarse o destruirse datos?
* **Disponibilidad:** ¿Puede interrumpirse el servicio?

**2. Impacto de Negocio:**
* **Financiero:** Costos directos por robo, multas regulatorias o pérdida de productividad.
* **Reputacional:** Pérdida de confianza de clientes e inversores.
* **Legal/Cumplimiento:** Violación de leyes (GDPR, PCI-DSS, HIPAA).

### B. Probabilidad (La Amenaza)
Mide cuán factible es que un atacante explote la vulnerabilidad. Factores que influyen:

* **Vector de Ataque:** ¿Se puede atacar desde internet (remoto) o requiere acceso físico?
* **Complejidad del Ataque:** ¿Requiere herramientas automatizadas básicas o conocimientos avanzados y desarrollo de exploits a medida?
* **Privilegios Requeridos:** ¿Lo puede hacer un usuario anónimo o se requiere una cuenta de administrador?
* **Interacción del Usuario:** ¿La víctima debe hacer clic en un enlace (Ingeniería Social) o el ataque es autónomo?

### C. Riesgo Cualitativo
Dado que es difícil asignar valores monetarios exactos o porcentajes precisos, se utiliza una matriz cualitativa para clasificar el riesgo final.

| Probabilidad / Impacto | Bajo | Medio | Alto |
| :--- | :--- | :--- | :--- |
| **Alta** | Riesgo Medio | Riesgo Alto | Riesgo Crítico |
| **Media** | Riesgo Bajo | Riesgo Medio | Riesgo Alto |
| **Baja** | Riesgo Informativo | Riesgo Bajo | Riesgo Medio |

* **Crítico:** Atención inmediata. El negocio está comprometido o la explotación es inminente/trivial.
* **Alto:** Atención urgente. Existe un camino claro hacia el compromiso del sistema.
* **Medio:** Atención programada. Dificultad alta de explotación o impacto limitado.
* **Bajo:** Atención según disponibilidad. Buenas prácticas de seguridad (Hardening).

---

## Resumen Ejecutivo 

Esta sección está dirigida a la alta dirección (C-Level: CEO, CTO, CISO), gerentes y stakeholders que no necesariamente poseen conocimientos técnicos profundos. Su objetivo es informar sobre el estado de seguridad general y justificar la inversión en remediación.

### Componentes Principales

1.  **Contexto y Alcance:**
    * Define claramente qué se auditó (dominios, rangos IP, aplicaciones móviles) y durante qué periodo de tiempo.
    * Establece las limitaciones de la prueba (ej. ventanas de mantenimiento, exclusiones específicas).

2.  **Estado General de la Seguridad:**
    * Una valoración cualitativa o gráfica (Dashboard) que indique la salud de la infraestructura.
    * Ejemplo: "La postura de seguridad se considera Baja debido a la presencia de vulnerabilidades críticas en sistemas expuestos a internet".

3.  **Resumen de Hallazgos Críticos:**
    * No es una lista exhaustiva. Se deben destacar solo los 3 a 5 riesgos más importantes que amenazan la continuidad del negocio.
    * Deben explicarse en términos de consecuencias empresariales, no técnicas (ej. en lugar de "SQL Injection en el parámetro ID", usar "Riesgo de fuga masiva de datos de clientes").

4.  **Impacto al Negocio:**
    * Traducción de los hallazgos a pérdidas tangibles: financieras, operativas, legales o reputacionales.

5.  **Hoja de Ruta de Recomendaciones:**
    * Propuesta estratégica de alto nivel para solucionar los problemas (ej. "Implementar autenticación multifactor en toda la organización" o "Establecer un programa de gestión de parches").

---

## Informe Técnico

Esta sección está dirigida al equipo de TI, desarrolladores, administradores de sistemas y equipos de seguridad (Blue Team). Su objetivo es proporcionar instrucciones precisas para reproducir y corregir los fallos.

### Componentes Principales

1.  **Metodología:**
    * Descripción del estándar utilizado (PTES, OSSTMM, OWASP) y las herramientas empleadas. Esto da validez científica y repetibilidad a la prueba.

2.  **Detalle de Vulnerabilidades:**
    Por cada hallazgo, se debe incluir una ficha técnica estructurada:
    * **Nombre y Clasificación:** Título de la vulnerabilidad y su ID (CVE si aplica).
    * **Severidad:** Puntuación (Crítica, Alta, Media, Baja) basada en estándares como CVSS.
    * **Descripción Técnica:** Explicación de qué es la vulnerabilidad y por qué ocurre.
    * **Ubicación:** URL, puerto, parámetro o línea de código afectada.
    * **Prueba de Concepto (PoC):** La parte más importante para el desarrollador. Debe incluir capturas de pantalla, scripts o los pasos exactos paso a paso para replicar el ataque. Sin reproducción, no hay verificación de parcheo.
    * **Remediación:** Instrucciones técnicas específicas para solucionar el fallo (ej. fragmentos de código seguro, comandos de configuración).

---

### CVSS (Common Vulnerability Scoring System)
Es el estándar industrial para estandarizar estas mediciones. Un auditor debe conocer sus tres grupos de métricas:

1.  **Métricas Base:** Las características intrínsecas de la vulnerabilidad (constantes en el tiempo y entornos).
2.  **Métricas Temporales:** Factores que cambian con el tiempo (ej. ¿existe ya un parche oficial? ¿hay código de explotación público?).
3.  **Métricas de Entorno:** Factores específicos de la organización (ej. ¿el sistema afectado almacena datos críticos o es irrelevante?).

Un buen reporte de pentesting ajusta el puntaje Base del CVSS usando las métricas de Entorno para reflejar el **Riesgo Real** para ese cliente específico.
